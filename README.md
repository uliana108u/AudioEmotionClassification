# Audio Emotion Classification

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=flat&logo=PyTorch&logoColor=white)](https://pytorch.org/)
[![HuggingFace Transformers](https://img.shields.io/badge/ü§ó%20Transformers-Loaded-yellow)](https://huggingface.co/transformers/)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç–º–æ—Ü–∏–π –≤ –≥–æ–ª–æ—Å–µ –∞–∫—Ç–µ—Ä–æ–≤. –ú–æ–¥–µ–ª—å, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–º `wav2vec2`, –æ–±—É—á–∞–µ—Ç—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —à–µ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π: `neutral`, `happy`, `sad`, `angry`, `fearful`, `surprised`.

##  –û –ø—Ä–æ–µ–∫—Ç–µ

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –∞—É–¥–∏–æ-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ - —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —ç–º–æ—Ü–∏–π –ø–æ —Ä–µ—á–µ–≤–æ–º—É —Å–∏–≥–Ω–∞–ª—É. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ—â–Ω–∞—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å `facebook/wav2vec2-base-960h`, –∫ –∫–æ—Ç–æ—Ä–æ–π –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ (transfer learning) –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç–∏—á—å –≤—ã—Å–æ–∫–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–∞–∂–µ –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.

**–¶–µ–ª–µ–≤—ã–µ —ç–º–æ—Ü–∏–∏:**
- `neutral` ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è
- `happy` ‚Äî —Ä–∞–¥–æ—Å—Ç—å
- `sad` ‚Äî –≥—Ä—É—Å—Ç—å
- `angry` ‚Äî –∑–ª–æ—Å—Ç—å
- `fearful` ‚Äî —Å—Ç—Ä–∞—Ö
- `surprised` ‚Äî —É–¥–∏–≤–ª–µ–Ω–∏–µ

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ú–æ—â–Ω–∞—è –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `wav2vec2` –æ—Ç Facebook AI, –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ 960 —á–∞—Å–∞—Ö —Ä–µ—á–∏
- **–ì–∏–±–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:** –í–∫–ª—é—á–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, —Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏ –ø–∞–¥–¥–∏–Ω–≥ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤
- **–ü–æ—ç—Ç–∞–ø–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:** –ó–∞–º–æ—Ä–æ–∑–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–ª–æ–µ–≤ —ç–Ω–∫–æ–¥–µ—Ä–∞
- **–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `AdamW` —Å weight decay –¥–ª—è –±–æ—Ä—å–±—ã —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ–±—É—á–µ–Ω–∏—è:** `ReduceLROnPlateau` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è learning rate

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ 
```
AudioEmotionClassification/
‚îú‚îÄ‚îÄ data/                   # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–∞ 
‚îÇ   ‚îî‚îÄ‚îÄ Actor_01/           # –ü–∞–ø–∫–∏ —Å –∞–∫—Ç–µ—Ä–∞–º–∏ (–ø–æ—Å–ª–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏)
‚îÇ       ‚îî‚îÄ‚îÄ *.wav
‚îú‚îÄ‚îÄ src/                      # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ dataset.py            # –ö–ª–∞—Å—Å EmotionDataset
‚îÇ   ‚îú‚îÄ‚îÄ EmotionClassifier.py  # –ö–ª–∞—Å—Å EmotionClassifier
‚îÇ   ‚îî‚îÄ‚îÄ main.py             # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ notebooks/                # Jupyter Notebooks –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ examples.ipynb
‚îú‚îÄ‚îÄ models/                # –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## –î–∞–Ω–Ω—ã–µ
–ö–æ–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞—Å–µ—Ç–æ–º RAVDESS (Ryerson Audio-Visual Database of Emotional Speech and Song).

**–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

- –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤ Audio_Song_Actors_01-24.zip

- –ü–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç–∞ –æ–Ω –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω –≤ –ø–∞–ø–∫—É data/

–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –≤ RAVDESS:
03-01-06-01-02-01-12.wav, –≥–¥–µ —Ç—Ä–µ—Ç—å–µ —á–∏—Å–ª–æ (06) - –∫–æ–¥ —ç–º–æ—Ü–∏–∏.

## –ú–æ–¥–µ–ª—å
EmotionClassifier —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:

- Feature Extractor (wav2vec2): –ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–∞—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∞—É–¥–∏–æ –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏

- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä: –î–≤—É—Ö—Å–ª–æ–π–Ω–∞—è –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π ReLU

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ:**

```bash
python main.py
```
**–ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

- –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ EmotionDataset

- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DataLoader —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π collate_fn

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏, —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞

- –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å –∑–∞–º–æ—Ä–æ–∑–∫–æ–π –≤–µ—Å–æ–≤ –∏ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π

## –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:

```
model = EmotionClassifier(num_classes=6)
model.load_state_dict(torch.load('path/to/best_model.pth'))
model.eval()

waveform = process_audio('new_audio.wav')

with torch.no_grad():
    logits = model(waveform)
    probs = torch.nn.functional.softmax(logits, dim=1)
    predicted_class = torch.argmax(probs, dim=1)
    predicted_emotion = emotion_classes[predicted_class]
    print(f"Predicted emotion: {predicted_emotion}")
```

##  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ RAVDESS –≤ —Ç–µ—á–µ–Ω–∏–µ 10 —ç–ø–æ—Ö –º–æ–¥–µ–ª—å –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:


| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| **Accuracy** | 87.3% | –û–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| **Precision (avg)** | 86.9% | –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º |
| **Recall (avg)** | 87.2% | –ü–æ–ª–Ω–æ—Ç–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º |
| **F1-Score (avg)** | 87.0% | F1-–º–µ—Ä–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º |
| **Validation Loss** | 0.42 | –§–∏–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å |

###  –ü–æ—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –≠–º–æ—Ü–∏—è | Precision | Recall | F1-Score | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ |
|--------|-----------|--------|----------|-----------|
| **neutral** | 89.2% | 91.5% | 90.3% | 120 |
| **happy** | 92.1% | 88.3% | 90.2% | 120 |
| **sad** | 83.4% | 85.7% | 84.5% | 120 |
| **angry** | 91.8% | 93.2% | 92.5% | 120 |
| **fearful** | 79.6% | 76.8% | 78.2% | 120 |
| **surprised** | 85.3% | 87.1% | 86.2% | 120 |



### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (1 –∞—É–¥–∏–æ)** | ~15 –º—Å |
| **–ü–∞–º—è—Ç—å –º–æ–¥–µ–ª–∏** | 95 –ú–ë |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ CPU/GPU** | ‚úÖ |
| **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∞—É–¥–∏–æ** | 4 —Å–µ–∫—É–Ω–¥—ã |

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞:
-  –ê–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–π –≤ call-—Ü–µ–Ω—Ç—Ä–∞—Ö
-  –û—Ü–µ–Ω–∫–∞ –∞–∫—Ç–µ—Ä—Å–∫–æ–≥–æ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
-  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
-  –ì–æ–ª–æ—Å–æ–≤—ã–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã —Å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ù–∞–∏–º–µ–Ω—å—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —ç–º–æ—Ü–∏—è—Ö **fearful** –∏ **sad**
- –¢—Ä–µ–±—É–µ—Ç —á–∏—Å—Ç–æ–≥–æ –∞—É–¥–∏–æ –±–µ–∑ —Ñ–æ–Ω–æ–≤–æ–≥–æ —à—É–º–∞
- –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∞—É–¥–∏–æ: 2-4 —Å–µ–∫—É–Ω–¥—ã
- –õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥—Ä–∞–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–µ—á—å—é (–∞–∫—Ç–µ—Ä—ã)

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –≤ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç–º–æ—Ü–∏–π –ø–æ –≥–æ–ª–æ—Å—É, –æ—Å–æ–±–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—è—Å—å –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ —è—Ä–∫–∏—Ö —ç–º–æ—Ü–∏–π (angry, happy). –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ wav2vec2 –ø–æ–∫–∞–∑–∞–ª–∞ —Å–≤–æ—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø—Ä–µ–≤–∑–æ–π–¥—è —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –Ω–∞ 8-19% –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∞—É–¥–∏–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ larger –≤–µ—Ä—Å–∏–∏ wav2vec2
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
- Ensemble –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π

